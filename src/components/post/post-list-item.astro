---
import type { CollectionEntry } from "astro:content";
import DateTag from "../date-tag.astro";
import Tag from "../tag.astro";

type Props = {
  post: CollectionEntry<"blog">;
};

const { post } = Astro.props;

// Si l'article a le tag "Archive", on ne l'affiche pas sauf si on est sur la page des Archives
const isArchivePage = decodeURIComponent(Astro.url.pathname).includes('/tags/Archive');

if (!isArchivePage && post.data.tags?.includes("Archive")) {
  return null; // Ne pas afficher les articles ayant le tag "Archive" sauf sur la page des Archives
}

---

<section>
  {
    post.slug && (
      <a href={`/posts/${post.slug}`} target="_self">
        {post.data.cover && (
          <figure>
            <img
              src={`${post.data.cover}?w=880&q=80`}
              alt="cover"
            />
          </figure>
        )}
      </a>
    )
  }
  <div>

    <a href={`/posts/${post.slug}`} target="_self">
      <h2 class="front-page-heading">{post.data.title}</h2>
    </a>

    <a href={`/posts/${post.slug}`} target="_self">
      <p class="summary">{post.data.description}</p>
    </a>

    <div class="meta">
      <DateTag date={post.data.date} />
      {post.data.tags?.filter(tag => tag !== "FranÃ§ais").map((tag) => <Tag tag={tag} />)}
    </div>

  </div>
</section>
